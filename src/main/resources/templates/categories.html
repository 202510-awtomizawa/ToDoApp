<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="#{category.title}">カテゴリ編集</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .category-page h1 { text-align: center; }
    .category-page .form-card { max-width: 640px; margin: 0 auto; }
    .category-page .form-group { margin-bottom: 16px; }
    .category-page .form-label { display: block; margin-bottom: 6px; font-weight: 500; }
    .category-page .form-control {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-sizing: border-box;
    }
    .category-page .form-control:focus {
      border-color: #17a2b8;
      box-shadow: 0 0 0 3px rgba(23, 162, 184, 0.1);
      outline: none;
    }
    .category-page input[type="color"].form-control {
      padding: 6px;
      height: 40px;
    }
    .category-page .category-block {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      background: #fff;
    }
    .category-page .category-id {
      font-size: 12px;
      color: #6c757d;
      margin-bottom: 8px;
    }
    .category-page .btn-primary {
      background: #17a2b8;
      color: #fff;
      padding: 10px 24px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
    }
    .category-page .actions {
      margin-top: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
    }
    .error { color: #c00; font-size: 12px; }
    .message { margin: 12px 0; color: #15803D; }
  </style>
</head>
<body class="category-page">
  <h1 th:text="#{category.title}">カテゴリ編集</h1>

  <div class="message" th:if="${message}" th:text="${message}"></div>

  <form method="post" th:action="@{/categories/update}" th:object="${form}">
    <div class="form-card">
      <div class="category-block" th:each="cat, stat : *{categories}">
        <div class="category-id">
          <span>ID:</span>
          <span th:text="${cat.id}">1</span>
          <input type="hidden" th:field="*{categories[__${stat.index}__].id}">
        </div>

        <div class="form-group">
          <label class="form-label" th:text="#{category.name}">カテゴリ名</label>
          <input type="text" class="form-control" placeholder="カテゴリ名"
                 th:field="*{categories[__${stat.index}__].name}">
          <div class="error"
               th:if="${#fields.hasErrors('categories[' + stat.index + '].name')}"
               th:errors="*{categories[__${stat.index}__].name}"></div>
        </div>

        <div class="form-group">
          <label class="form-label" th:text="#{category.color}">色</label>
          <input type="color" class="form-control"
                 th:field="*{categories[__${stat.index}__].color}">
        </div>
      </div>
    </div>

    <div class="actions">
      <button type="submit" class="btn-primary" th:text="#{button.save}">保存</button>
      <a th:href="@{/todos}" th:text="#{button.to_list}">ToDo一覧へ</a>
    </div>
  </form>
</body>
</html>
